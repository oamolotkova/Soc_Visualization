---
title: "Soc_concat"
author: "Olga Molotkova"
date: "2025-03-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Объединение файлов

Я взяла три txt-файла от Василисы в формате full-record с цитатами:
*savedrecs*, *savedrecs (1)*, *savedrecs (2)*. Запрос был PY=(2022-2024) AND SU=Sociology and CU=Russia. Получилась выдача на 1264 статьи.

Присоединю их к общему файлу *CompleteData_Sociology.txt* из папки https://disk.yandex.ru/client/disk/ANR-Lab%20General/Projects/WoS%20Russian%20Science/WoS%20Russia/Subsets/Preprocessing%20for%20Pajek/Sociology

Для начала загружу файлы в библиометрикс, чтобы просмотреть содержимое файлов, поработать с табличным объединением и сравнить его с походом объединения текстовых файлов Владо.

```{r}
#install.packages('bibliometrix')
##library(bibliometrix) 
##bibliometrix:: biblioshiny()
##biblioshiny(maxUploadSize=600) #for big files
```

```{r}
library(readxl)
library(dplyr)
```

```{r}
savedrecs <- read_excel("Bibliometrix-Export-savedrecs.xlsx")
glimpse(savedrecs)
```
```{r}
savedrecs1 <- read_excel("Bibliometrix-Export-savedrecs (1).xlsx")
glimpse(savedrecs1)
```

```{r}
savedrecs2 <- read_excel("Bibliometrix-Export-savedrecs (2).xlsx")
glimpse(savedrecs2)
```
```{r}
CompleteData_Sociology <- read_excel("Bibliometrix-Export-CompleteData_Sociology.xlsx")
glimpse(CompleteData_Sociology)
```

Количество столбцов не совпадает. Проверим, какими столбцами отличаются датафреймы.

```{r}
#install.packages("janitor")
library("janitor")
```

```{r}
janitor::compare_df_cols(savedrecs, savedrecs1, savedrecs2, CompleteData_Sociology)
```
Смотрим на сайте значения отсутсвующих в части датафреймов столбцов: https://images.webofknowledge.com/images/help/WOS/hs_wos_fieldtags.html

BE - Editors
BN - International Standard Book Number (ISBN)
CL - Conference Location
CT - Conference Title
CY - Conference Date
C3 - *??*
EF - *End of File*
GP - Book Group Authors
HC - ESI Highly Cited Paper. Note that this field is valued only for ESI subscribers.
HO - Conference Host
HP - ESI Hot Paper. Note that this field is valued only for ESI subscribers
SE - Book Series Title
SP - Conference Sponsors
SU - Supplement

Показались странными столбцы С3 и EF, проверила в текстовых файлах:
EF - просто аббревиатура в конце, можно удалить. 
C3 - вероятно, адрес автора, как и C1. Интересно, что написание C1 тоже отличается в файлах.

1. Пример C3 в файле **savedrecs**: Russian Presidential Academy of National Economy & Public Administration
2. Пример C1 в файле **savedrecs**: [Malakhov, Vladimir S.] RANEPA, Sch Adv Studies Humanities, Inst Social Sci, Vernadsky prosp 82, Moscow 119571, Russia.
3. Пример C1 в файле **СompleteData_Sociology**: C1 RUSSIAN NATL PUBL OPIN RES CTR,MOSCOW,RUSSIA.

Проверим, какие типы публикаций в файлах.

```{r}
savedrecs$DT <- as.factor(savedrecs$DT)
summary(savedrecs$DT)
```
```{r}
savedrecs1$DT <- as.factor(savedrecs1$DT)
summary(savedrecs1$DT)
```


```{r}
savedrecs2$DT <- as.factor(savedrecs2$DT)
summary(savedrecs2$DT)
```


```{r}
CompleteData_Sociology$DT <- as.factor(CompleteData_Sociology$DT)
summary(CompleteData_Sociology$DT)
```
Хотя в файлах типы публикаций не полностью совпадают, значительно отличается файл CompleteData_Sociology, в котором есть главы книг и материалы конференций.
